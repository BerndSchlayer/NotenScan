#!/usr/bin/env bash
set -euo pipefail

# Nach erfolgreichem Commit yalc im Frontend wieder aktivieren,
# damit die lokale Entwicklung direkt weitergeht.
REPO_ROOT="$(git rev-parse --show-toplevel)"
FRONTEND_DIR="$REPO_ROOT/Frontend"
PKG_JSON="$FRONTEND_DIR/package.json"

if [ -f "$PKG_JSON" ]; then
  # Nur re-aktivieren, wenn nicht bereits file:.yalc gesetzt ist
  if ! grep -q '"@schlayer-consulting/sc-base-frontend"\s*:\s*"file:\.yalc' "$PKG_JSON"; then
    (
      cd "$FRONTEND_DIR"
      # leise versuchen; wenn yalc nicht installiert ist, nicht fehlschlagen
      npx yalc add @schlayer-consulting/sc-base-frontend >/dev/null 2>&1 || true
    )
  fi
fi
